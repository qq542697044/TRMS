{"remainingRequest":"E:\\Github\\code\\TRMS\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\Github\\code\\TRMS\\src\\views\\Login\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\Github\\code\\TRMS\\src\\views\\Login\\index.vue","mtime":1582694062312},{"path":"E:\\Github\\code\\TRMS\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\Github\\code\\TRMS\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\Github\\code\\TRMS\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\Github\\code\\TRMS\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgc2hhMSBmcm9tICdqcy1zaGExJw0KaW1wb3J0IHtsb2dpbn0gZnJvbSAiQC9hcGkvbG9naW4iDQppbXBvcnQge3JlYWN0aXZlLHJlZixvbk1vdW50ZWR9IGZyb20gIkB2dWUvY29tcG9zaXRpb24tYXBpIjsNCmV4cG9ydCBkZWZhdWx0IHsNCiAgbmFtZTogImxvZ2luIiwNCiAgc2V0dXAocHJvcHMsY29udGV4dCl7DQogICAgLy/lh73mlbDlr7nosaENCiAgICBsZXQgdmFsaWRhdGV1c2VyTmFtZSA9IChydWxlLCB2YWx1ZSwgY2FsbGJhY2spID0+IHsNCiAgICAgIHZhciByZWcgPSAvXlthLXpBLVowLTldezMsMTV9JC87DQogICAgICBpZiAodmFsdWUgPT09ICcnKSB7DQogICAgICAgIHJldHVybiBjYWxsYmFjayhuZXcgRXJyb3IoJ+eUqOaIt+WQjeS4jeiDveS4uuepuicpKTsNCiAgICAgIH1lbHNlIGlmKCFyZWcudGVzdCh2YWx1ZSkpew0KICAgICAgICByZXR1cm4gY2FsbGJhY2sobmV3IEVycm9yKCfnlKjmiLflkI3moLzlvI/mnInor68nKSk7DQogICAgICB9ZWxzZSB7DQogICAgICAgIGNhbGxiYWNrKCk7DQogICAgICB9DQogICAgfTsNCiAgICBsZXQgdmFsaWRhdGVQYXNzID0gKHJ1bGUsIHZhbHVlLCBjYWxsYmFjaykgPT4gew0KICAgICAgdmFyIHJlZz0vXlthLXpBLVowLTldezUsMTV9JC87DQogICAgICBpZiAodmFsdWUgPT09ICcnKSB7DQogICAgICAgIGNhbGxiYWNrKG5ldyBFcnJvcign6K+36L6T5YWl5a+G56CBJykpOw0KICAgICAgfSBlbHNlIGlmKCFyZWcudGVzdCh2YWx1ZSkpew0KICAgICAgICBjYWxsYmFjayhuZXcgRXJyb3IoJ+WvhueggeW6lOS4uumVv+W6pjYtMTXkvY3nmoTlrZfmr43mlbDlrZfnu4TlkIgnKSk7DQogICAgICB9DQogICAgICBlbHNlIHsNCiAgICAgICAgaWYgKHJ1bGVGb3JtLmNoZWNrUGFzcyAhPT0gJycpIHsNCiAgICAgICAgICBjb250ZXh0LnJlZnMucnVsZUZvcm0udmFsaWRhdGVGaWVsZCgnY2hlY2tQYXNzJyk7DQogICAgICAgIH0NCiAgICAgICAgY2FsbGJhY2soKTsNCiAgICAgIH0NCiAgICB9Ow0KICAgIGxldCB2YWxpZGF0ZVBhc3MyID0gKHJ1bGUsIHZhbHVlLCBjYWxsYmFjaykgPT4gew0KICAgICAgaWYgKHZhbHVlID09PSAnJykgew0KICAgICAgICBjYWxsYmFjayhuZXcgRXJyb3IoJ+ivt+WGjeasoei+k+WFpeWvhueggScpKTsNCiAgICAgIH0gZWxzZSBpZiAodmFsdWUgIT09IHJ1bGVGb3JtLnVzZXJQYXNzKSB7DQogICAgICAgIGNhbGxiYWNrKG5ldyBFcnJvcign5Lik5qyh6L6T5YWl5a+G56CB5LiN5LiA6Ie0IScpKTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIGNhbGxiYWNrKCk7DQogICAgICB9DQogICAgfTsNCiAgICAvL+i/memHjOaUvue9rmRhdGHmlbDmja7jgIHnlJ/lkb3lkajmnJ/jgIHoh6rlrprkuYnlh73mlbANCiAgICBjb25zdCBtZW51VGFiID0gcmVhY3RpdmUoWw0KICAgICAgICAgIHt0ZXh0OifnmbvlvZUnLGN1cnJlbnQ6dHJ1ZSx0eXBlOid1c2VyJ30sDQogICAgICAgICAge3RleHQ6J+azqOWGjCcsY3VycmVudDpmYWxzZSx0eXBlOidzaWdudXAnfSwNCiAgICAgICAgICB7dGV4dDon566h55CG5ZGYJyxjdXJyZW50OmZhbHNlLHR5cGU6J2FkbWluJ30NCiAgICAgICAgXSk7DQogICAgLy/mqKHlnZflgLwNCiAgICBjb25zdCBtb3VkZWwgPSByZWYoJ3VzZXInKTsNCiAgICAvL+ihqOWNlee7keWumuaVsOaNrg0KICAgIGNvbnN0IHJ1bGVGb3JtID0gcmVhY3RpdmUoew0KICAgICAgICB1c2VyTmFtZTogJycsDQogICAgICAgIHVzZXJQYXNzOiAnJywNCiAgICAgICAgY2hlY2tQYXNzOiAnJw0KICAgIH0pOw0KICAgIC8v6KGo5Y2V6aqM6K+BDQogICAgY29uc3QgcnVsZXMgPSByZWFjdGl2ZSh7DQogICAgICAgIHVzZXJOYW1lOiBbDQogICAgICAgICAgeyB2YWxpZGF0b3I6IHZhbGlkYXRldXNlck5hbWUsIHRyaWdnZXI6ICdibHVyJyB9DQogICAgICAgIF0sDQogICAgICAgIHVzZXJQYXNzOiBbDQogICAgICAgICAgeyB2YWxpZGF0b3I6IHZhbGlkYXRlUGFzcywgdHJpZ2dlcjogJ2JsdXInIH0NCiAgICAgICAgXSwNCiAgICAgICAgY2hlY2tQYXNzOiBbDQogICAgICAgICAgeyB2YWxpZGF0b3I6IHZhbGlkYXRlUGFzczIsIHRyaWdnZXI6ICdibHVyJyB9DQogICAgICAgIF0NCiAgICB9KTsNCiAgICAvL+WHveaVsA0KICAgIGNvbnN0IHRvZ2dsZU1lbnUgPSBkYXRhPT57DQogICAgICANCiAgICAgIG1lbnVUYWIuZm9yRWFjaChlbGVtZW50ID0+IHsNCiAgICAgICAgZWxlbWVudC5jdXJyZW50PWZhbHNlOw0KICAgICAgfSk7DQogICAgICAgIC8v6auY5YWJDQogICAgICBkYXRhLmN1cnJlbnQ9dHJ1ZTsNCiAgICAgICAgLy/kv67mlLnmqKHlnZflgLwNCiAgICAgIG1vdWRlbC52YWx1ZT1kYXRhLnR5cGU7DQogICAgICAgIC8v5riF6Zmk6KGo5Y2VDQogICAgICByZXNldEZvcm0oKTsNCiAgICB9Ow0KDQogICAgLy/muIXpmaTooajljZUNCiAgICBjb25zdCByZXNldEZvcm0gPSAoKT0+ew0KICAgICAgY29udGV4dC5yZWZzWydydWxlRm9ybSddLnJlc2V0RmllbGRzKCk7DQogICAgfQ0KICAgIC8v5o+Q5Lqk6KGo5Y2VDQogICAgY29uc3Qgc3VibWl0Rm9ybSA9IChmb3JtTmFtZSkgPT57DQogICAgICBjb250ZXh0LnJlZnNbZm9ybU5hbWVdLnZhbGlkYXRlKCh2YWxpZCkgPT4gew0KICAgICAgICAgIGlmICh2YWxpZCkgew0KICAgICAgICAgICAgbGV0IG9iaj17DQogICAgICAgICAgICAgIHVzZXJOYW1lOnJ1bGVGb3JtLnVzZXJOYW1lLA0KICAgICAgICAgICAgICB1c2VyUGFzczpzaGExKHJ1bGVGb3JtLnVzZXJQYXNzKSwNCiAgICAgICAgICAgICAgbW91ZGVsOm1vdWRlbC52YWx1ZQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgbG9naW4ob2JqKS50aGVuKChyZXNwb25zZSk9PnsNCiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2FkbWluJykNCiAgICAgICAgICAgICAgICBpZihtb3VkZWwudmFsdWU9PT0nYWRtaW4nKXsNCiAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCk9PnsNCiAgICAgICAgICAgICAgICAgICAgY29udGV4dC5yb290LiRyb3V0ZXIucHVzaCh7DQogICAgICAgICAgICAgICAgICAgICAgbmFtZTogJ0NvbnNvbGUnLA0KICAgICAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICAgICAgfSwxMDAwKQ0KICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICB9ZWxzZXsNCg0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pLmNhdGNoKChlcnJvcik9PnsNCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgIH1lbHNlIHsNCiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdlcnJvciBzdWJtaXQhIScpOw0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgIH0NCiAgICAgIH0pDQogICAgfTsNCiAgICAvKg0KICAgICog55Sf5ZG95ZGo5pyfDQogICAgKi8gDQogICAvL+aMgui9veWujOaIkOWQjg0KICAgb25Nb3VudGVkKCgpPT57DQogICB9KTsNCiAgIHJldHVybnsNCiAgICAgbWVudVRhYiwNCiAgICAgbW91ZGVsLA0KICAgICB0b2dnbGVNZW51LA0KICAgICBydWxlcywNCiAgICAgcnVsZUZvcm0sDQogICAgIHN1Ym1pdEZvcm0sDQogICAgIHZhbGlkYXRldXNlck5hbWUsDQogICAgIHZhbGlkYXRlUGFzcywNCiAgICAgdmFsaWRhdGVQYXNzMg0KICAgfTsNCiAgfQ0KfTsNCg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/Login","sourcesContent":["<template>\r\n  <div id=\"login\">\r\n    <div class=\"cover\"><p>交通资源管理系统</p></div>\r\n    <div class=\"login-wrap\">\r\n      <ul class=\"menu-tab\">\r\n        <li v-for=\"item in menuTab\" :key=\"item.id\" :class=\"{'current':item.current}\" @click=\"toggleMenu(item)\">{{item.text}}</li>\r\n      </ul>\r\n      <!-- 表单 --> \r\n      <el-form :model=\"ruleForm\" status-icon :rules=\"rules\" ref=\"ruleForm\" class=\"login-form\" size=\"medium\">\r\n        <el-form-item prop=\"userName\" class=\"item-form\">\r\n          <label for=\"\">用户名</label>\r\n        <el-input type=\"text\" v-model=\"ruleForm.userName\" maxlength=\"15\"></el-input>\r\n        </el-form-item>\r\n\r\n        <el-form-item prop=\"userPass\" class=\"item-form\">\r\n          <label for=\"\">密码</label>\r\n        <el-input type=\"password\" v-model=\"ruleForm.userPass\" autocomplete=\"off\"></el-input>\r\n        </el-form-item>\r\n\r\n        <el-form-item prop=\"checkPass\" class=\"item-form\" v-if=\"moudel=='signup'\">\r\n          <label for=\"\">确认密码</label>\r\n        <el-input type=\"password\" v-model=\"ruleForm.checkPass\" autocomplete=\"off\"></el-input>\r\n        </el-form-item>\r\n\r\n        <el-form-item>\r\n        <el-button :type=\"moudel=='signup'?'danger':'primary'\" @click=\"submitForm('ruleForm')\" class=\"login-btn block\" >{{moudel=='signup'?'注册':'登录'}}</el-button>\r\n        </el-form-item>\r\n\r\n      </el-form>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport sha1 from 'js-sha1'\r\nimport {login} from \"@/api/login\"\r\nimport {reactive,ref,onMounted} from \"@vue/composition-api\";\r\nexport default {\r\n  name: \"login\",\r\n  setup(props,context){\r\n    //函数对象\r\n    let validateuserName = (rule, value, callback) => {\r\n      var reg = /^[a-zA-Z0-9]{3,15}$/;\r\n      if (value === '') {\r\n        return callback(new Error('用户名不能为空'));\r\n      }else if(!reg.test(value)){\r\n        return callback(new Error('用户名格式有误'));\r\n      }else {\r\n        callback();\r\n      }\r\n    };\r\n    let validatePass = (rule, value, callback) => {\r\n      var reg=/^[a-zA-Z0-9]{5,15}$/;\r\n      if (value === '') {\r\n        callback(new Error('请输入密码'));\r\n      } else if(!reg.test(value)){\r\n        callback(new Error('密码应为长度6-15位的字母数字组合'));\r\n      }\r\n      else {\r\n        if (ruleForm.checkPass !== '') {\r\n          context.refs.ruleForm.validateField('checkPass');\r\n        }\r\n        callback();\r\n      }\r\n    };\r\n    let validatePass2 = (rule, value, callback) => {\r\n      if (value === '') {\r\n        callback(new Error('请再次输入密码'));\r\n      } else if (value !== ruleForm.userPass) {\r\n        callback(new Error('两次输入密码不一致!'));\r\n      } else {\r\n        callback();\r\n      }\r\n    };\r\n    //这里放置data数据、生命周期、自定义函数\r\n    const menuTab = reactive([\r\n          {text:'登录',current:true,type:'user'},\r\n          {text:'注册',current:false,type:'signup'},\r\n          {text:'管理员',current:false,type:'admin'}\r\n        ]);\r\n    //模块值\r\n    const moudel = ref('user');\r\n    //表单绑定数据\r\n    const ruleForm = reactive({\r\n        userName: '',\r\n        userPass: '',\r\n        checkPass: ''\r\n    });\r\n    //表单验证\r\n    const rules = reactive({\r\n        userName: [\r\n          { validator: validateuserName, trigger: 'blur' }\r\n        ],\r\n        userPass: [\r\n          { validator: validatePass, trigger: 'blur' }\r\n        ],\r\n        checkPass: [\r\n          { validator: validatePass2, trigger: 'blur' }\r\n        ]\r\n    });\r\n    //函数\r\n    const toggleMenu = data=>{\r\n      \r\n      menuTab.forEach(element => {\r\n        element.current=false;\r\n      });\r\n        //高光\r\n      data.current=true;\r\n        //修改模块值\r\n      moudel.value=data.type;\r\n        //清除表单\r\n      resetForm();\r\n    };\r\n\r\n    //清除表单\r\n    const resetForm = ()=>{\r\n      context.refs['ruleForm'].resetFields();\r\n    }\r\n    //提交表单\r\n    const submitForm = (formName) =>{\r\n      context.refs[formName].validate((valid) => {\r\n          if (valid) {\r\n            let obj={\r\n              userName:ruleForm.userName,\r\n              userPass:sha1(ruleForm.userPass),\r\n              moudel:moudel.value\r\n            }\r\n            login(obj).then((response)=>{\r\n              console.log('admin')\r\n                if(moudel.value==='admin'){\r\n                  setTimeout(()=>{\r\n                    context.root.$router.push({\r\n                      name: 'Console',\r\n                    })\r\n                  },1000)\r\n                 \r\n                }else{\r\n\r\n                }\r\n            }).catch((error)=>{\r\n            });\r\n          }else {\r\n            console.log('error submit!!');\r\n            return false;\r\n          }\r\n      })\r\n    };\r\n    /*\r\n    * 生命周期\r\n    */ \r\n   //挂载完成后\r\n   onMounted(()=>{\r\n   });\r\n   return{\r\n     menuTab,\r\n     moudel,\r\n     toggleMenu,\r\n     rules,\r\n     ruleForm,\r\n     submitForm,\r\n     validateuserName,\r\n     validatePass,\r\n     validatePass2\r\n   };\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n#login {\r\n  height: 100vh;\r\n  background-color: #344a5f;\r\n  background-image: url('../../img/background2.png');\r\n  background-position: center center;\r\n  background-size: 750px;\r\n}\r\n\r\n.cover{\r\n  height: 72px;\r\n  font-size: 40px;\r\n  line-height: 72px;\r\n  color: #fff;\r\n  text-align: center;\r\n  padding: 30px 0 30px 0;\r\n}\r\n\r\n.login-wrap{\r\n  width:330px;\r\n  margin:auto;\r\n}\r\n\r\n.menu-tab{\r\n  text-align: center;\r\n  li{\r\n    display: inline-block;\r\n    width:88px;\r\n    line-height: 36px;\r\n    font-size: 14px;\r\n    color:#fff;\r\n    border-radius: 2px 2px 0 0;\r\n    cursor: pointer;\r\n    border-bottom: 2px solid white;\r\n  }\r\n  .current{\r\n    background-color: rgba(0,0,0, 0.5);\r\n  }\r\n}\r\n\r\n.login-form{\r\n  margin-top:29px;\r\n  label {\r\n    display: block;\r\n    margin-bottom: 3px;\r\n    font-size: 14px;\r\n    color: #fff;\r\n  }\r\n  .item-form{\r\n    margin-bottom: 13px;\r\n  }\r\n  .block{\r\n    display: block;\r\n    width: 100%;\r\n  }\r\n  .login-btn{\r\n    margin-top: 19px;\r\n  }\r\n}\r\n</style>\r\n"]}]}